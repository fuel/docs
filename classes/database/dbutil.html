<!doctype html>
<html lang="ja">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="./../../assets/css/combined.css">
	<link rel="shortcut icon" href="./../../favicon.ico" />
	<script src="http://www.google.com/jsapi" type="text/javascript"></script>
	<script type="text/javascript">
		var path = './../../';
		var class_prefix = "DBUtil::";
	</script>
	<script src="./../../assets/js/combined.js"></script>
	<title>DBUtil - クラス - FuelPHP ドキュメント</title>
</head>
<body>
	<div id="container">
		<header id="header">
			<div class="table">
				<h1>
					<strong>FuelPHP, a PHP 5.3 Framework</strong>
					Documentation
				</h1>

				<form id="google_search">
					<p>
						<span id="search_clear">&nbsp;</span>
						<input type="submit" name="search_submit" id="search_submit" value="検索" />
						<input type="text" value="" id="search_input" name="search_input" />
					</p>
				</form>
			</div>
			<nav>

				<div class="clear"></div>
			</nav>
			<a href="#" id="toc_handle">目次</a>
			<div class="clear"></div>
		</header>

		<div id="cse">
			<div id="cse_point"></div>
			<div id="cse_content"></div>
		</div>

		<div id="main">

			<h2>DBUtil クラス</h2>

			<p>DBUtil クラスは、データベースに対するルーチン操作を管理し、行なうことを可能にします。</p>

			<h3 id="managing">関数を利用する</h3>

			<p>DBUtil は、データベースのカラムを作成、リネーム、変更、および削除することを可能にします。</p>

			<article>
				<h4 class="method" id="method_set_connection">set_connection($connection)</h4>
				<p><strong>set_connection</strong> メソッドは、すべてのメソッドのための、デフォルトのデータベース接続をセットします。</p>
				<table class="method">
					<tbody>
						<tr>
							<th>静的</th>
							<td>はい</td>
						</tr>
						<tr>
							<th>パラメータ</th>
							<td>
								<table class="parameters">
									<tr>
										<th>パラメータ</th>
										<th>デフォルト</th>
										<th class="description">説明</th>
									</tr>
									<tr>
										<th><kbd>$connection</kbd></th>
										<td><strong>必須</strong></td>
										<td class="description">データベース接続</td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<th>返り値</th>
							<td>影響する行の数</td>
						</tr>
						<tr>
							<th>例外</th>
							<td>失敗時に \Database_Exception が発生</td>
						</tr>
						<tr>
							<th>例</th>
							<td>
								<pre class="php"><code>// DBUtil の代替データベース接続を設定
DBUtil::set_connection('my_database_group');

// そのコネクションを用いて他の DBUtil を呼び出す
...

// デフォルトに戻す
DBUtil::set_connection(null);
</code></pre>
							</td>
						</tr>
					</tbody>
				</table>
			</article>

			<article>
				<h4 class="method" id="method_create_database">create_database($database, $charset = null, $if_not_exists = true, $db = null)</h4>
				<p><strong>create_database</strong> メソッドは、データベースを作成します。もし失敗した場合には、例外 Database_Exception がスローされます。</p>
				<table class="method">
					<tbody>
						<tr>
							<th>静的</th>
							<td>はい</td>
						</tr>
						<tr>
							<th>パラメータ</th>
							<td>
								<table class="parameters">
									<tr>
										<th>パラメータ</th>
										<th>デフォルト</th>
										<th class="description">説明</th>
									</tr>
									<tr>
										<th><kbd>$database</kbd></th>
										<td><em>必須</em></td>
										<td>データベース名</td>
									</tr>
									<tr>
										<th><kbd>$charset</kbd></th>
										<td><em>null</em></td>
										<td>デフォルトの文字コード</td>
									</tr>
									<tr>
										<th><kbd>$if_not_exists</kbd></th>
										<td><strong>true</strong></td>
										<td><em>IF NOT EXISTS</em>をつけるかどうか</td>
									</tr>
									<tr>
										<th><kbd>$db</kbd></th>
										<td><pre class="php"><code>null</code></pre></td>
										<td class="description">データベース接続</td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<th>返り値</th>
							<td>影響する行の数</td>
						</tr>
						<tr>
							<th>例外</th>
							<td>失敗時に \Database_Exception が発生</td>
						</tr>
						<tr>
							<th>例</th>
							<td>
								<pre class="php"><code>// `my_database` というデータベースを作成します。
DBUtil::create_database('my_database');

// 例外を捕捉
try
{
	DBUtil::create_database('my_database');
}
catch(\Database_Exception $e)
{
	// 生成に失敗...
}

// デフォルトの文字コードもセットできます。
// `new_database` が存在しなければ、デフォルトの文字コードセットを `utf8` としてデータベースを作成
DBUtil::create_database('new_database', 'utf8');

// `new_database` が存在しなければ、デフォルトの文字コードセットを `utf8` 、collate を `utf8_unicode_ci` としてデータベースを作成
DBUtil::create_database('new_database', 'utf8_unicode_ci');
</code></pre>
							</td>
						</tr>
					</tbody>
				</table>
				<p>もし、文字コードが指定されなかった場合、アクティブな DB グループの文字コードが適用されます。</p>
			</article>

			<article>
				<h4 class="method" id="method_drop_database">drop_database($database, $db = null)</h4>
				<p><strong>drop_database</strong> メソッドは、データベースを削除します。もし失敗した場合には、例外 Database_Exception がスローされます。</p>
				<table class="method">
					<tbody>
						<tr>
							<th>静的</th>
							<td>はい</td>
						</tr>
						<tr>
							<th>パラメータ</th>
							<td>
								<table class="parameters">
									<tr>
										<th>パラメータ</th>
										<th>デフォルト</th>
										<th class="description">説明</th>
									</tr>
									<tr>
										<th><kbd>$database</kbd></th>
										<td><em>必須</em></td>
										<td>データベース名</td>
									</tr>
									<tr>
										<th><kbd>$db</kbd></th>
										<td><pre class="php"><code>null</code></pre></td>
										<td class="description">データベース接続</td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<th>返り値</th>
							<td>影響する行の数</td>
						</tr>
						<tr>
							<th>例外</th>
							<td>失敗時には \Database_Exception が発生</td>
						</tr>
						<tr>
							<th>例</th>
							<td>
								<pre class="php"><code>// `my_database` という名前のデータベースを削除
DBUtil::drop_database('my_database');

// 例外を捕捉
try
{
	DBUtil::drop_database('my_database');
}
catch(\Database_Exception $e)
{
	// 削除失敗...
}
</code></pre>
							</td>
						</tr>
					</tbody>
				</table>
			</article>

			<article>
				<h4 class="method" id="method_table_exists">table_exists($table, $db = null)</h4>
				<p><strong>table_exists</strong> メソッドは、与えられたテーブルが存在するかチェックします。</p>
				<table class="method">
					<tbody>
						<tr>
							<th>静的</th>
							<td>はい</td>
						</tr>
						<tr>
							<th>パラメータ</th>
							<td>
								<table class="parameters">
									<tr>
										<th>パラメータ</th>
										<th>デフォルト</th>
										<th class="description">説明</th>
									</tr>
									<tr>
										<td><kbd>$table</kbd></td>
										<td><em>必須</em></td>
										<td>テーブル名</td>
									</tr>
									<tr>
										<th><kbd>$db</kbd></th>
										<td><pre class="php"><code>null</code></pre></td>
										<td class="description">データベース接続</td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<th>返り値</th>
							<td>テーブルが存在する場合は true、存在しない場合は false が返ります</td>
						</tr>
						<tr>
							<th>例</th>
							<td>
								<pre class="php"><code>// `my_table` テーブルが存在するか確かめる
if(DBUtil::table_exists('my_table'))
{
	// テーブルが存在する
} else
{
	// テーブルが存在しなければ作成
}</code>
								</pre>
							</td>
						</tr>
					</tbody>
				</table>
			</article>

			<article>
				<h4 class="method" id="method_drop_table">drop_table($table, $db = null)</h4>
				<p><strong>drop_table</strong> メソッドは、テーブルを削除します。もし失敗した場合には、例外 Database_Exception がスローされます。</p>
				<table class="method">
					<tbody>
						<tr>
							<th>静的</th>
							<td>はい</td>
						</tr>
						<tr>
							<th>パラメータ</th>
							<td>
								<table class="parameters">
									<tr>
										<th>パラメータ</th>
										<th>デフォルト</th>
										<th class="description">説明</th>
									</tr>
									<tr>
										<th><kbd>$table</kbd></th>
										<td><em>必須</em></td>
										<td>テーブル名</td>
									</tr>
									<tr>
										<th><kbd>$db</kbd></th>
										<td><pre class="php"><code>null</code></pre></td>
										<td class="description">データベース接続</td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<th>返り値</th>
							<td>影響する行の数</td>
						</tr>
						<tr>
							<th>例外</th>
							<td>失敗時には \Database_Exception が発生</td>
						</tr>
						<tr>
							<th>例</th>
							<td>
								<pre class="php"><code>// `my_table` というテーブルを削除します。
DBUtil::drop_table('my_table');

// 例外を捕捉
try
{
	DBUtil::drop_table('my_table');
}
catch(\Database_Exception $e)
{
	// 削除失敗...
}
</code></pre>
							</td>
						</tr>
					</tbody>
				</table>
			</article>

			<article>
				<h4 class="method" id="method_rename_table">rename_table($table, $new_table_name, $db = null)</h4>
				<p><strong>rename_table</strong> メソッドは、テーブルをリネームします。</p>
				<table class="method">
					<tbody>
						<tr>
							<th>静的</th>
							<td>はい</td>
						</tr>
						<tr>
							<th>パラメータ</th>
							<td>
								<table class="parameters">
									<tr>
										<th>パラメータ</th>
										<th>デフォルト</th>
										<th class="description">説明</th>
									</tr>
									<tr>
										<th><kbd>$table</kbd></th>
										<td><em>必須</em></td>
										<td>古いテーブル名</td>
									</tr>
									<tr>
										<th><kbd>$new_table_name</kbd></th>
										<td><em>必須</em></td>
										<td>新しいテーブル名</td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<th>返り値</th>
							<td>影響する行の数</td>
						</tr>
						<tr>
							<th>例外</th>
							<td>失敗時には \Database_Exception が発生</td>
						</tr>
						<tr>
							<th>例</th>
							<td>
								<pre class="php"><code>// `my_table` というテーブルを `my_new_table` にリネームします。
DBUtil::rename_table('my_table', 'my_new_table');

// 例外を捕捉
try
{
	DBUtil::rename_table('my_table', 'my_new_table');
}
catch(\Database_Exception $e)
{
	// リネーム失敗...
}
</code></pre>
							</td>
						</tr>
					</tbody>
				</table>
			</article>

			<article>
				<h4 class="method" id="method_create_table">create_table($table, $fields, $primary_keys = array(), $if_not_exists = true, $engine = false, $charset = null, $foreign_keys = array(), $db = null)</h4>
				<p><strong>create_table</strong> メソッドは、テーブルを作成します。</p>
				<table class="method">
					<tbody>
						<tr>
							<th>静的</th>
							<td>はい</td>
						</tr>
						<tr>
							<th>パラメータ</th>
							<td>
								<table class="parameters">
									<tr>
										<th>パラメータ</th>
										<th>デフォルト</th>
										<th class="description">説明</th>
									</tr>
									<tr>
										<th><kbd>$table</kbd></th>
										<td><em>必須</em></td>
										<td>テーブル名</td>
									</tr>
									<tr>
										<th><kbd>$fields</kbd></th>
										<td><em>必須</em></td>
										<td>フィールドを含む配列</td>
									</tr>
									<tr>
										<th><kbd>$primary_keys</kbd></th>
										<td><strong>array()</strong></td>
										<td>プライマリキーを含む配列</td>
									</tr>
									<tr>
										<th><kbd>$if_not_exists</kbd></th>
										<td><strong>true</strong></td>
										<td><em>IF NOT EXISTS</em> を使うかどうか</td>
									</tr>
									<tr>
										<th><kbd>$engine</kbd></th>
										<td><strong>false</strong></td>
										<td>どのストレージエンジン (MyISAM, InnoDB, ...) を使うか</td>
									</tr>
									<tr>
										<th><kbd>$charset</kbd></th>
										<td><pre class="php"><code>null</code></pre></td>
										<td>デフォルトの文字セット。指定しないとアクティブな DB グループの文字セットが使われる</td>
									</tr>
									<tr>
										<th><kbd>$foreign_keys</kbd></th>
										<td><strong>array()</strong></td>
										<td>外部キー制約の定義を含む配列。配列のキーとして 'key' と 'reference' が必要で、これらがないとエラーが発生する。それ以外は任意指定。</td>
									</tr>
									<tr>
										<th><kbd>$db</kbd></th>
										<td><pre class="php"><code>null</code></pre></td>
										<td class="description">データベース接続</td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<th>返り値</th>
							<td>影響する行の数</td>
						</tr>
						<tr>
							<th>例外</th>
							<td>失敗時に \Database_Exception</td>
						</tr>
						<tr>
							<th>例</th>
							<td>
								<pre class="php"><code>\DBUtil::create_table(
	'users',
	array(
		'id' => array('constraint' => 11, 'type' => 'int', 'auto_increment' => true),
		'name' => array('type' => 'text'),
		'email' => array('constraint' => 50, 'type' => 'varchar'),
		'title' => array('constraint' => 50, 'type' => 'varchar', 'default' => 'mr.'),
		'password' => array('constraint' => 125, 'type' => 'varchar'),
	),
	array('id'), false, 'InnoDB', 'utf8_unicode_ci',
	array(
		array(
			'constraint' => 'constraintA',
			'key' => 'keyA',
			'reference' => array(
				'table' => 'table',
				'column' => 'field',
			),
			'on_update' => 'CASCADE',
			'on_delete' => 'RESTRICT'
		),
		array(
			'key' => 'keyB',
			'reference' => array(
				'table' => 'table',
				'column' => array(
					'fieldA',
					'fieldB'
				),
			),
		),
	),
);

/* 以下の SQL 文が生成される:
CREATE TABLE `users` (
	`id` int(11) NOT NULL AUTO_INCREMENT,
	`name` text NOT NULL,
	`email` varchar(50) NOT NULL,
	`title` varchar(50) DEFAULT 'mr.' NOT NULL,
	`password` varchar(125) NOT NULL,
	PRIMARY KEY `id` (`id`),
	CONSTRAINT constraintA FOREIGN KEY (keyA) REFERENCES table (field) ON UPDATE CASCADE ON DELETE RESTRICT,
	FOREIGN KEY (keyB) REFERENCES table (fieldA, fieldB)
) ENGINE = InnoDB  DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci;
*/</code></pre>
							</td>
						</tr>
						<tr>
							<th>指定可能なパラメータ</th>
							<td>
								<table class="parameters">
									<tr>
										<th>パラメータ</th>
										<th class="description">説明</th>
									</tr>
									<tr>
										<th><kbd>name</kbd></th>
										<td>フィールド名</td>
									</tr>
									<tr>
										<th><kbd>type</kbd></th>
										<td>フィールドの型 (varchar, enum, text, ...)</td>
									</tr>
									<tr>
										<th><kbd>constraint</kbd></th>
										<td>長さ。配列で指定することも可能</td>
									</tr>
									<tr>
										<th><kbd>charset</kbd></th>
										<td>文字セット</td>
									</tr>
									<tr>
										<th><kbd>unsigned</kbd></th>
										<td>boolean 値で、符号なしの時は <em>true</em> 。デフォルトは <em>false</em></td>
									</tr>
									<tr>
										<th><kbd>default</kbd></th>
										<td>デフォルト値</td>
									</tr>
									<tr>
										<th><kbd>null</kbd></th>
										<td>boolean 値で、null を許可する時は <em>true</em> 。デフォルトは <em>false</em></td>
									</tr>
									<tr>
										<th><kbd>auto_increment</kbd></th>
										<td>オートインクリメントを使う時は <em>true</em> に設定する</td>
									</tr>
									<tr>
										<th><kbd>comment</kbd></th>
										<td>フィールドにコメントを追加する</td>
									</tr>
								</table>
							</td>
						</tr>
					</tbody>
				</table>

				<p>フィールドのデフォルト値は自動的にエスケープされます。エスケープしてほしくない場合には、 <a href="./db.html#method_expr">DB::expr</a> を使います。</p>
				<pre class="php"><code>\DBUtil::create_table('users', array(
	'id' => array('constraint' => 11, 'type' => 'int', 'auto_increment' => true),
	'name' => array('type' => 'text'),
	'email' => array('constraint' => 50, 'type' => 'varchar'),
	'title' => array('constraint' => 50, 'type' => 'varchar', 'default' => 'mr.'),
	'created' => array('type' => 'timestamp', 'default' => \DB::expr('CURRENT_TIMESTAMP')),
	'password' => array('constraint' => 125, 'type' => 'varchar'),
), array('id'));
</code></pre>

				<p>値のエスケープは DBUtil::add_fields と DBUtil::modify_fields についても同様の動作をします。</p>

			</article>

			<article>
				<h4 class="method" id="method_field_exists">field_exists($table, $columns, $db = null)</h4>
				<p><strong>field_exists</strong> メソッドは、与えられたテーブルに与えられたカラムが存在しているかチェックします。</p>
				<table class="method">
					<tbody>
						<tr>
							<th>静的</th>
							<td>はい</td>
						</tr>
						<tr>
							<th>パラメータ</th>
							<td>
								<table class="parameters">
									<tr>
										<th>パラメータ</th>
										<th>デフォルト</th>
										<th class="description">説明</th>
									</tr>
									<tr>
										<td>$table</td>
										<td>必須</td>
										<td>テーブル名</td>
									</tr>
									<tr>
										<td>$columns</td>
										<td>必須</td>
										<td>フィールドを含む配列</td>
									</tr>
									<tr>
										<th><kbd>$db</kbd></th>
										<td><pre class="php"><code>null</code></pre></td>
										<td class="description">データベース接続</td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<th>返り値</th>
							<td>フィールド/カラムが存在すれば true、存在しなければ false</td>
						</tr>
						<tr>
							<th>例</th>
							<td>
								<pre class="php"><code>
if(DBUtil::field_exists('my_table', array('my_field_or_column')))
{
	// フィールドが存在する
}
else
{
	// このテーブルではフィールドが存在しない
}</code>
								</pre>
							</td>
						</tr>
					</tbody>
				</table>
			</article>

			<article>
				<h4 class="method" id="method_add_fields">add_fields($table, $fields, $db = null)</h4>
				<p><strong>add_fields</strong> メソッドは、テーブルにカラムを追加します。</p>
				<table class="method">
					<tbody>
						<tr>
							<th>静的</th>
							<td>はい</td>
						</tr>
						<tr>
							<th>パラメータ</th>
							<td>
								<table class="parameters">
									<tr>
										<th>パラメータ</th>
										<th>デフォルト</th>
										<th class="description">説明</th>
									</tr>
									<tr>
										<th><kbd>$table</kbd></th>
										<td><em>必須</em></td>
										<td>テーブル名</td>
									</tr>
									<tr>
										<th><kbd>$fields</kbd></th>
										<td><em>必須</em></td>
										<td>フィールドを含む配列</td>
									</tr>
									<tr>
										<th><kbd>$db</kbd></th>
										<td><pre class="php"><code>null</code></pre></td>
										<td class="description">データベース接続</td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<th>返り値</th>
							<td>影響する行の数</td>
						</tr>
						<tr>
							<th>例外</th>
							<td>失敗時に \Database_Exception</td>
						</tr>
						<tr>
							<th>例</th>
							<td>
								<pre class="php"><code>\DBUtil::add_fields('users', array(
	'surname' => array('constraint' => 100, 'type' => 'varchar'),
	'twitter_name' => array('constraint' => 100, 'type' => 'varchar'),
));
</code></pre>
							</td>
						</tr>
					</tbody>
				</table>
			</article>

			<article>
				<h4 class="method" id="method_drop_fields">drop_fields($table, $fields, $db = null)</h4>
				<p><strong>drop_fields</strong>メソッドは、テーブルからカラムを削除します。</p>
				<table class="method">
					<tbody>
						<tr>
							<th>静的</th>
							<td>はい</td>
						</tr>
						<tr>
							<th>パラメータ</th>
							<td>
								<table class="parameters">
									<tr>
										<th>パラメータ</th>
										<th>デフォルト</th>
										<th class="description">説明</th>
									</tr>
									<tr>
										<th><kbd>$table</kbd></th>
										<td><em>必須</em></td>
										<td>テーブル名</td>
									</tr>
									<tr>
										<th><kbd>$fields</kbd></th>
										<td><em>必須</em></td>
										<td>フィールドを含む文字列か配列</td>
									</tr>
									<tr>
										<th><kbd>$db</kbd></th>
										<td><pre class="php"><code>null</code></pre></td>
										<td class="description">データベース接続</td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<th>返り値</th>
							<td>影響する行の数</td>
						</tr>
						<tr>
							<th>例外</th>
							<td>失敗時に \Database_Exception</td>
						</tr>
						<tr>
							<th>例</th>
							<td>
								<pre class="php"><code>\DBUtil::drop_fields('users', 'surname');</code></pre>
							</td>
						</tr>
					</tbody>
				</table>
			</article>

			<article>
				<h4 class="method" id="method_modify_fields">modify_fields($table, $fields, $db = null)</h4>
				<p><strong>modify_fields</strong> メソッドは、テーブルのカラムを変更します。</p>
				<table class="method">
					<tbody>
						<tr>
							<th>静的</th>
							<td>はい</td>
						</tr>
						<tr>
							<th>パラメータ</th>
							<td>
								<table class="parameters">
									<tr>
										<th>パラメータ</th>
										<th>デフォルト</th>
										<th class="description">説明</th>
									</tr>
									<tr>
										<th><kbd>$table</kbd></th>
										<td><em>必須</em></td>
										<td>テーブル名</td>
									</tr>
									<tr>
										<th><kbd>$fields</kbd></th>
										<td><em>必須</em></td>
										<td>フィールドを含む配列</td>
									</tr>
									<tr>
										<th><kbd>$db</kbd></th>
										<td><pre class="php"><code>null</code></pre></td>
										<td class="description">データベース接続</td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<th>返り値</th>
							<td>影響する行の数</td>
						</tr>
						<tr>
							<th>例外</th>
							<td>失敗時に\Database_Exception</td>
						</tr>
						<tr>
							<th>例</th>
							<td>
								<pre class="php"><code>\DBUtil::modify_fields('users2', array(
	'name' => array('constraint' => 100, 'type' => 'varchar', 'charset' => 'utf8_general_ci'),
	'title' => array('constraint' => 50, 'type' => 'varchar', 'default' => 'mrs.'),
));
</code></pre>
							</td>
						</tr>
					</tbody>
				</table>
			</article>

			<article>
				<h4 class="method" id="method_create_index">create_index($table, $index_columns, $index_name, $index = '', $db = null)</h4>
				<p><strong>create_index</strong> メソッドは、テーブルにインデックスを追加します。</p>
				<table class="method">
					<tbody>
						<tr>
							<th>静的</th>
							<td>はい</td>
						</tr>
						<tr>
							<th>パラメータ</th>
							<td>
								<table class="parameters">
									<tr>
										<th>パラメータ</th>
										<th>デフォルト</th>
										<th class="description">説明</th>
									</tr>
									<tr>
										<th><kbd>$table</kbd></th>
										<td><em>必須</em></td>
										<td>テーブル名</td>
									</tr>
									<tr>
										<th><kbd>$index_columns</kbd></th>
										<td><em>必須</em></td>
										<td>フィールドを含む文字列または文字列の配列</td>
									</tr>
									<tr>
										<th><kbd>$index_name</kbd></th>
										<td><em>任意</em></td>
										<td>作成するインデックスの名前</td>
									</tr>
									<tr>
										<th><kbd>$index</kbd></th>
										<td><em>任意</em></td>
										<td>作成するインデックスの種類。<br />現時点でサポートされているのは、UNIQUE、FULLTEXT、SPATIAL、NONCLUSTERED</td>
									</tr>
									<tr>
										<th><kbd>$db</kbd></th>
										<td><pre class="php"><code>null</code></pre></td>
										<td class="description">データベース接続</td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<th>返り値</th>
							<td>影響する行の数</td>
						</tr>
						<tr>
							<th>例外</th>
							<td>失敗時に \Database_Exception</td>
						</tr>
						<tr>
							<th>例</th>
							<td>
								<pre class="php"><code>\DBUtil::create_index('table', 'name');
// CREATE INDEX name ON table ( `name` ) を生成

\DBUtil::create_index('table', array('nameA', 'nameB'), 'name');
// CREATE INDEX name ON table ( `nameA`, `nameB` ) を生成

\DBUtil::create_index('table', array('nameA' => 'ASC', 'nameB'), 'name', 'fulltext');
// CREATE FULLTEXT INDEX name ON table ( `nameA` ASC, `nameB` ) を生成
</code></pre>
							</td>
						</tr>
					</tbody>
				</table>
			</article>

			<article>
				<h4 class="method" id="method_drop_index">drop_index($table, $index_name, $db = null)</h4>
				<p><strong>drop_index</strong> メソッドは、テーブルからインデックスを削除します。</p>
				<table class="method">
					<tbody>
						<tr>
							<th>静的</th>
							<td>はい</td>
						</tr>
						<tr>
							<th>パラメータ</th>
							<td>
								<table class="parameters">
									<tr>
										<th>パラメータ</th>
										<th>デフォルト</th>
										<th class="description">説明</th>
									</tr>
									<tr>
										<th><kbd>$table</kbd></th>
										<td><em>必須</em></td>
										<td>テーブル名</td>
									</tr>
									<tr>
										<th><kbd>$index_name</kbd></th>
										<td><em>必須</em></td>
										<td>削除するインデックスの名前</td>
									</tr>
									<tr>
										<th><kbd>$db</kbd></th>
										<td><pre class="php"><code>null</code></pre></td>
										<td class="description">データベース接続</td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<th>返り値</th>
							<td>データベース操作の結果</td>
						</tr>
						<tr>
							<th>例外</th>
							<td>失敗時に \Database_Exception</td>
						</tr>
						<tr>
							<th>例</th>
							<td>
								<pre class="php"><code>\DBUtil::drop_index('table', 'name');
// DROP INDEX name ON table を生成
</code></pre>
							</td>
						</tr>
					</tbody>
				</table>
			</article>

			<article>
				<h4 class="method" id="method_add_foregin_key">add_foregin_key($table, $foreign_key)</h4>
				<p><strong>add_foreign_key</strong> メソッドは、既存テーブルに外部キーを追加します。</p>
				<table class="method">
					<tbody>
						<tr>
							<th>静的</th>
							<td>はい</td>
						</tr>
						<tr>
							<th>パラメータ</th>
							<td>
								<table class="parameters">
									<tr>
										<th>パラメータ</th>
										<th>デフォルト</th>
										<th class="description">説明</th>
									</tr>
									<tr>
										<th><kbd>$table</kbd></th>
										<td><em>必須</em></td>
										<td>テーブル名</td>
									</tr>
									<tr>
										<th><kbd>$foreign_key</kbd></th>
										<td><em>必須</em></td>
										<td>外部キー定義を含む配列</td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<th>返り値</th>
							<td>データベース操作の結果</td>
						</tr>
						<tr>
							<th>例外</th>
							<td>不正な入力時に \InvalidArgumentException 、失敗時に \Database_Exception</td>
						</tr>
						<tr>
							<th>例</th>
							<td>
								<pre class="php"><code>\DBUtil::add_foreign_key('users', array(
	'constraint' => 'constraintA',
	'key' => 'keyA',
	'reference' => array(
		'table' => 'table',
		'column' => 'field',
	),
	'on_update' => 'CASCADE',
	'on_delete' => 'RESTRICT'
));</code></pre>
							</td>
						</tr>
					</tbody>
				</table>
			</article>

			<article>
				<h4 class="method" id="method_drop_foreign_key">drop_foreign_key($table, $fk_name)</h4>
				<p><strong>drop_foreign_key</strong> メソッドは、テーブルから外部キーを削除します。</p>
				<table class="method">
					<tbody>
						<tr>
							<th>静的</th>
							<td>はい</td>
						</tr>
						<tr>
							<th>パラメータ</th>
							<td>
								<table class="parameters">
									<tr>
										<th>パラメータ</th>
										<th>デフォルト</th>
										<th class="description">説明</th>
									</tr>
									<tr>
										<th><kbd>$table</kbd></th>
										<td><em>必須</em></td>
										<td>テーブル名</td>
									</tr>
									<tr>
										<th><kbd>$fk_name</kbd></th>
										<td><em>必須</em></td>
										<td>削除する外部キーの名前</td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<th>返り値</th>
							<td>データベース操作の結果</td>
						</tr>
						<tr>
							<th>例外</th>
							<td>失敗時に\Database_Exception</td>
						</tr>
						<tr>
							<th>例</th>
							<td>
								<pre class="php"><code>\DBUtil::drop_foreign_key('table', 'name');
// ALTER TABLE `table` DROP FOREIGN KEY name を生成
</code></pre>
							</td>
						</tr>
					</tbody>
				</table>
			</article>

			<h3 id="database-operations">データベースの操作</h3>

			<article>
				<h4 class="method" id="method_truncate_table">truncate_table($table, $db = null)</h4>
				<p><strong>truncate_table</strong> メソッドは、テーブルを切りつめます。</p>
				<table class="method">。
					<tbody>
						<tr>
							<th>静的</th>
							<td>はい</td>
						</tr>
						<tr>
							<th>パラメータ</th>
							<td>
								<table class="parameters">
									<tr>
										<th>パラメータ</th>
										<th>デフォルト</th>
										<th class="description">説明</th>
									</tr>
									<tr>
										<th><kbd>$table</kbd></th>
										<td><em>必須</em></td>
										<td class="description">テーブル名.</td>
									</tr>
									<tr>
										<th><kbd>$db</kbd></th>
										<td><pre class="php"><code>null</code></pre></td>
										<td class="description">データベース接続</td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<th>返り値</th>
							<td>影響する行の数</td>
						</tr>
						<tr>
							<th>例外</th>
							<td>サポートされていない時に \Database_Exception</td>
						</tr>
						<tr>
							<th>例</th>
							<td>
								<pre class="php"><code>\DBUtil::truncate_table('my_table');</code></pre>
							</td>
						</tr>
					</tbody>
				</table>
			</article>

			<article>
				<h4 class="method" id="method_analyze_table">analyze_table($table, $db = null)</h4>
				<p><strong>analyze_table</strong> メソッドは、テーブルを分析します</p>
				<table class="method">
					<tbody>
						<tr>
							<th>静的</th>
							<td>はい</td>
						</tr>
						<tr>
							<th>パラメータ</th>
							<td>
								<table class="parameters">
									<tr>
										<th>パラメータ</th>
										<th>デフォルト</th>
										<th class="description">説明</th>
									</tr>
									<tr>
										<th><kbd>$table</kbd></th>
										<td><em>必須</em></td>
										<td class="description">テーブル名.</td>
									</tr>
									<tr>
										<th><kbd>$db</kbd></th>
										<td><pre class="php"><code>null</code></pre></td>
										<td class="description">データベース接続</td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<th>返り値</th>
							<td>テーブルが OK なら <em>true</em> 。注意が必要なら <em>false</em> 。サポートされていなければエラーメッセージをログに記録する</td>
						</tr>
						<tr>
							<th>例</th>
							<td>
								<pre class="php"><code>if(\DBUtil::analyze_table('table_name') === false)
{
	// 何か処理を行う
}
</code></pre>
							</td>
						</tr>
					</tbody>
				</table>
			</article>

			<article>
				<h4 class="method" id="method_check_table">check_table($table, $db = null)</h4>
				<p><strong>check_table</strong> メソッドは、テーブルをチェックします。</p>
				<table class="method">
					<tbody>
						<tr>
							<th>静的</th>
							<td>はい</td>
						</tr>
						<tr>
							<th>パラメータ</th>
							<td>
								<table class="parameters">
									<tr>
										<th>パラメータ</th>
										<th>デフォルト</th>
										<th class="description">説明</th>
									</tr>
									<tr>
										<th><kbd>$table</kbd></th>
										<td><em>必須</em></td>
										<td class="description">テーブル名.</td>
									</tr>
									<tr>
										<th><kbd>$db</kbd></th>
										<td><pre class="php"><code>null</code></pre></td>
										<td class="description">データベース接続</td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<th>返り値</th>
							<td>テーブルが OK なら <em>true</em> 。注意が必要なら <em>false</em> 。サポートされていなければエラーメッセージをログに記録する</td>
						</tr>
						<tr>
							<th>例</th>
							<td>
								<pre class="php"><code>if(\DBUtil::check_table('table_name') === false)
{
	// 何か処理を行う
}
</code></pre>
							</td>
						</tr>
					</tbody>
				</table>
			</article>

			<article>
				<h4 class="method" id="method_optimize_table">optimize_table($table, $db = null)</h4>
				<p><strong>optimize_table</strong> メソッドは、テーブルを最適化します</p>
				<table class="method">
					<tbody>
						<tr>
							<th>静的</th>
							<td>はい</td>
						</tr>
						<tr>
							<th>パラメータ</th>
							<td>
								<table class="parameters">
									<tr>
										<th>パラメータ</th>
										<th>デフォルト</th>
										<th class="description">説明</th>
									</tr>
									<tr>
										<th><kbd>$table</kbd></th>
										<td><em>必須</em></td>
										<td class="description">テーブル名.</td>
									</tr>
									<tr>
										<th><kbd>$db</kbd></th>
										<td><pre class="php"><code>null</code></pre></td>
										<td class="description">データベース接続</td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<th>返り値</th>
							<td>テーブルが OK なら <em>true</em> 。注意が必要なら <em>false</em> 。サポートされていなければエラーメッセージをログに記録する</td>
						</tr>
						<tr>
							<th>例</th>
							<td>
								<pre class="php"><code>if(\DBUtil::optimize_table('table_name') === false)
{
	// 何か処理を行う
}
</code></pre>
							</td>
						</tr>
					</tbody>
				</table>
			</article>

			<article>
				<h4 class="method" id="method_repair_table">repair_table($table, $db = null)</h4>
				<p><strong>repair_table</strong> メソッドは、テーブルを修復します</p>
				<table class="method">
					<tbody>
						<tr>
							<th>静的</th>
							<td>はい</td>
						</tr>
						<tr>
							<th>パラメータ</th>
							<td>
								<table class="parameters">
									<tr>
										<th>パラメータ</th>
										<th>デフォルト</th>
										<th class="description">説明</th>
									</tr>
									<tr>
										<th><kbd>$table</kbd></th>
										<td><em>必須</em></td>
										<td class="description">テーブル名</td>
									</tr>
									<tr>
										<th><kbd>$db</kbd></th>
										<td><pre class="php"><code>null</code></pre></td>
										<td class="description">データベース接続</td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<th>返り値</th>
							<td>テーブルが OK なら <em>true</em> 。注意が必要なら <em>false</em> 。サポートされていなければエラーメッセージをログに記録する</td>
						</tr>
						<tr>
							<th>例</th>
							<td>
								<pre class="php"><code>if(\DBUtil::repair_table('table_name') === false)
{
	// 何か処理を行う
}
</code></pre>
							</td>
						</tr>
					</tbody>
				</table>
			</article>

		</div>

		<footer>
			<p>
				&copy; FuelPHP Development Team 2010-2013 - <a href="http://fuelphp.com">FuelPHP</a> is released under the MIT license.
[ <a href="https://github.com/fuel/docs/commits/1.7/develop/classes/database/dbutil.html">原文コミット履歴</a> | <a href="https://github.com/NEKOGET/FuelPHP_docs_jp/commits/1.7/develop_japanese/classes/database/dbutil.html">翻訳コミット履歴</a> | <a href="https://github.com/NEKOGET/FuelPHP_docs_jp/blob/1.7/develop_japanese/classes/database/dbutil.html">GitHubで修正</a> ]
			</p>
		</footer>
	</div>
</body>
</html>
